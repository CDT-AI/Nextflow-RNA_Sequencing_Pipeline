pdf('CONTROL_REP4.DupRate_plot.pdf')
par(mar=c(5,4,4,5),las=0)
seq_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,113,114,115,117,118,119,120,121,122,124,125,126,127,128,129,130,131,132,133,134,135,136,138,139,140,141,143,144,145,146,147,148,149,150,153,154,155,158,159,160,164,165,167,169,170,171,172,174,175,179,180,181,182,183,184,185,190,192,193,194,195,197,199,202,203,204,205,208,209,212,218,219,220,223,224,225,227,228,230,236,237,245,246,248,254,255,258,259,260,270,271,273,291,295,298,303,310,317,326,329,330,331,333,337,341,352,355,378,380,381,384,386,393,395,400,406,410,412,417,418,422,427,436,468,484,492,495,502,503,513,533,564,579,599,668,731,838,866,910,924,1282,1410,1549)
seq_uniqRead=c(41619,7907,3778,2235,1418,1064,729,609,436,349,296,228,218,175,182,133,117,116,98,88,111,68,70,53,56,48,57,48,62,40,36,47,32,30,29,36,22,33,23,23,24,25,21,24,23,22,24,19,24,21,12,17,18,12,15,13,12,8,15,8,8,16,11,12,6,14,9,9,9,12,9,6,11,10,2,8,11,6,5,7,4,3,9,7,5,2,5,6,6,7,4,3,4,4,1,6,5,4,2,1,4,6,4,2,2,6,3,5,5,2,3,3,3,3,4,7,5,4,7,4,3,1,2,5,2,2,3,4,2,1,3,3,3,1,4,5,3,3,1,1,3,1,1,2,1,3,2,1,2,1,1,2,1,4,2,2,1,1,1,1,3,2,1,2,1,1,2,4,2,2,2,1,5,2,1,2,1,1,2,1,4,2,1,1,2,1,2,1,1,1,1,3,1,3,1,1,1,1,1,2,1,2,2,1,1,2,2,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,2,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
pos_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,139,140,141,142,143,144,145,147,148,149,150,152,153,154,155,156,157,158,159,160,162,163,164,165,167,168,169,171,173,174,176,177,178,180,181,182,184,186,187,188,191,192,193,195,199,200,201,203,204,206,207,208,209,210,211,213,214,215,218,219,225,226,227,228,230,234,236,237,238,241,242,246,248,250,251,252,258,262,263,264,265,269,274,275,276,280,283,284,289,291,303,306,308,313,322,324,326,327,330,344,346,350,351,367,374,376,380,399,400,406,411,412,422,423,424,430,435,438,441,446,449,453,454,460,461,471,486,489,503,530,532,535,539,544,561,574,605,624,639,687,715,785,902,917,976,1006,1350,1487,1646)
pos_uniqRead=c(20717,7426,3880,2368,1568,1118,833,626,488,424,341,252,257,172,199,146,132,142,114,109,102,100,83,61,57,52,56,44,48,59,54,37,36,40,36,26,31,33,35,25,23,33,22,23,19,26,22,25,25,16,17,17,29,13,15,20,10,15,13,6,12,14,10,11,11,10,13,12,7,8,12,12,5,7,10,6,7,4,10,7,3,12,9,3,12,7,8,5,4,5,3,1,6,4,7,4,5,5,4,6,3,3,3,1,3,7,5,1,4,3,7,2,3,3,6,3,2,5,3,1,2,3,3,6,8,2,1,2,6,2,2,4,4,1,1,2,2,4,2,3,1,3,1,1,2,4,4,6,2,2,1,1,2,1,1,1,2,5,1,1,1,2,2,1,1,1,1,2,2,1,1,1,1,1,3,1,2,1,2,1,2,1,2,1,1,3,4,1,2,2,1,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,2,1,2,1,1,1,1,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
plot(pos_occ,log10(pos_uniqRead),ylab='Number of Reads (log10)',xlab='Occurrence of read',pch=4,cex=0.8,col='blue',xlim=c(1,500),yaxt='n')
points(seq_occ,log10(seq_uniqRead),pch=20,cex=0.8,col='red')
ym=floor(max(log10(pos_uniqRead)))
legend(300,ym,legend=c('Sequence-based','Mapping-based'),col=c('blue','red'),pch=c(4,20))
axis(side=2,at=0:ym,labels=0:ym)
axis(side=4,at=c(log10(pos_uniqRead[1]),log10(pos_uniqRead[2]),log10(pos_uniqRead[3]),log10(pos_uniqRead[4])), labels=c(round(pos_uniqRead[1]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[2]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[3]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[4]*100/sum(pos_uniqRead*pos_occ))))
mtext(4, text = "Reads %", line = 2)
dev.off()
