pdf('CONTROL_REP2.DupRate_plot.pdf')
par(mar=c(5,4,4,5),las=0)
seq_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,188,189,190,191,194,195,196,197,198,199,200,201,203,205,206,209,210,211,212,213,215,217,218,220,222,225,226,227,228,229,231,233,234,237,238,239,240,241,244,245,247,248,250,253,254,259,260,262,263,264,266,267,268,270,271,272,275,276,277,281,287,290,291,292,293,295,299,300,301,303,305,306,307,308,311,312,314,317,318,319,323,324,326,332,333,335,336,339,340,345,349,355,359,362,364,370,371,374,375,378,381,384,385,386,388,389,391,395,399,400,415,416,420,425,426,429,432,434,435,436,438,441,442,444,445,448,457,464,470,471,475,479,485,505,509,510,514,515,516,525,527,561,583,595,615,627,632,634,650,657,678,744,745,753,775,799,851,861,886,897,917,987,1029,1068,1081,1117,1241,1243,1306,1326,1469,1487,1536,2028,3251)
seq_uniqRead=c(57247,10675,5155,3101,1960,1411,1049,792,630,513,426,371,290,278,224,191,196,151,142,130,114,118,99,83,81,73,65,74,52,66,55,53,48,54,49,48,39,33,32,34,42,34,25,25,29,23,16,29,24,22,27,22,25,26,26,17,23,14,21,21,13,16,12,11,23,18,16,14,14,14,16,8,11,15,10,12,14,10,17,13,12,12,11,5,6,12,7,12,10,9,6,9,10,7,10,5,3,4,8,3,5,5,9,5,10,4,8,7,3,4,7,6,7,4,4,4,5,7,1,5,7,4,4,5,1,2,2,2,4,4,4,8,4,4,1,3,1,3,3,3,4,3,5,6,3,2,2,5,3,4,3,4,3,4,3,1,1,2,4,4,3,3,2,5,1,3,1,3,1,2,3,1,5,2,1,1,2,1,1,2,1,3,2,3,2,1,2,2,1,1,1,2,2,1,1,1,1,2,2,1,2,1,4,1,3,1,1,2,1,2,2,1,3,1,1,1,1,1,1,2,1,1,1,2,1,2,1,2,1,1,2,1,1,1,1,4,1,2,1,3,1,2,1,1,1,1,2,1,1,1,1,1,1,3,1,1,1,2,1,1,2,1,1,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,2,1,2,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
pos_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,169,170,171,172,173,174,175,176,178,179,180,181,182,183,185,186,187,189,190,191,192,193,194,196,197,198,199,200,202,204,205,206,207,208,210,211,213,214,217,219,220,221,222,223,224,226,227,230,233,234,235,236,237,238,239,240,241,243,245,248,249,250,252,253,256,257,259,261,262,263,264,266,268,269,271,273,274,276,277,281,282,283,284,285,286,288,291,292,296,299,301,302,306,307,310,311,312,313,316,319,320,321,323,326,328,329,332,334,339,340,342,352,354,359,364,365,371,375,379,381,388,389,397,399,401,403,404,405,406,407,410,411,419,435,441,443,444,447,450,454,455,462,465,467,472,473,475,478,482,484,489,490,492,501,504,507,511,513,522,532,537,538,539,543,546,552,555,564,570,601,621,627,637,642,652,659,663,664,687,702,721,724,773,787,797,838,850,906,914,942,965,983,1047,1106,1120,1175,1236,1294,1315,1389,1415,1552,1568,1678,2153,3453)
pos_uniqRead=c(25517,9016,5013,3214,2113,1519,1193,857,663,554,481,435,326,289,268,231,233,167,147,137,138,118,102,97,85,88,84,66,59,74,72,71,50,56,43,46,40,56,41,39,44,32,23,30,32,24,32,21,31,23,21,28,37,22,22,11,20,18,25,15,17,18,18,21,12,13,13,17,17,12,17,15,12,17,8,13,10,14,15,10,12,10,11,13,13,16,12,6,11,8,8,6,5,7,6,7,7,8,12,10,8,8,3,8,5,4,4,6,8,7,8,4,8,6,6,5,4,6,6,3,3,3,2,3,4,4,10,5,3,3,5,4,2,6,5,4,7,8,4,2,3,3,2,2,2,6,1,1,3,2,5,1,4,3,2,6,4,1,1,4,4,6,4,2,3,2,2,4,2,4,4,2,5,2,2,2,5,4,1,1,1,1,2,4,1,1,3,1,3,1,3,2,4,2,1,3,1,1,2,1,1,2,4,2,2,2,2,3,1,1,1,2,1,1,1,1,1,1,1,3,1,1,1,3,1,1,1,1,2,1,2,2,2,1,1,1,2,2,1,1,1,1,1,2,1,2,1,3,2,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,2,3,2,2,1,1,1,1,1,2,1,3,2,1,1,1,3,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,3,1,1,1,1,1,1,1,2,1,1,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
plot(pos_occ,log10(pos_uniqRead),ylab='Number of Reads (log10)',xlab='Occurrence of read',pch=4,cex=0.8,col='blue',xlim=c(1,500),yaxt='n')
points(seq_occ,log10(seq_uniqRead),pch=20,cex=0.8,col='red')
ym=floor(max(log10(pos_uniqRead)))
legend(300,ym,legend=c('Sequence-based','Mapping-based'),col=c('blue','red'),pch=c(4,20))
axis(side=2,at=0:ym,labels=0:ym)
axis(side=4,at=c(log10(pos_uniqRead[1]),log10(pos_uniqRead[2]),log10(pos_uniqRead[3]),log10(pos_uniqRead[4])), labels=c(round(pos_uniqRead[1]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[2]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[3]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[4]*100/sum(pos_uniqRead*pos_occ))))
mtext(4, text = "Reads %", line = 2)
dev.off()
